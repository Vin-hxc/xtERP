<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script src="../static/layui/layui/layui.js"></script>
    <link rel="stylesheet" href="../static/layui/layui/css/layui.css" />
    <link rel="stylesheet" href="/static/css/H-ui.min.css">
    <script src="/static/css/jquery-1.8.3.min.js"></script>
    <script src="/static/css/jquery.dataTables.min.js"></script>

</head>
<body>
<table  id = "tbo"
        class="table table-border table-bordered table-hover table-bg table-sort">
    <thead>
    <tr >
        <th colspan="16" height="15px" style="color: #F4F4F4">
            <button class="layui-btn layui-btn-sm" id="btnInsert" >增加</button>
            <button class="layui-btn layui-btn-sm" id="btnDelete">删除</button>
            <button class="layui-btn layui-btn-sm" id="btnOpen">启用</button>
            <button class="layui-btn layui-btn-sm" id="btnClose">禁用</button>
            <button class="layui-btn layui-btn-sm" id="btnOut">导出</button>
        </th>
    </tr>
    <tr class="text-c">
        <th width="20px"><input type="checkbox" id="checkAll" name="checkAll"</th>
        <th width="100">编号</th>
        <th width="100">产品名称</th>
        <th width="100">产品型号</th>
        <th width="100">产品类型</th>
        <th width="100">单位</th>
        <th width="100">库存</th>
        <th width="100">零售价</th>
        <th width="100">最低售价</th>
        <th width="100">成本价格</th>
        <th width="100">销售价格</th>
        <th width="100">产品状态</th>
        <th width="100">序列号</th>
        <th width="150">创建时间</th>
        <th width="100">审核状态</th>
        <th width="100">操作</th>
    </tr>
    </thead>
    <tbody>
    <tr th:each="product:${listproducthash}" height="40px" class="text-c" id="tr1">
        <td><input type="checkbox" name="ckb" class="proid" th:value="${product.id}"></td>
        <td th:text="${product.id}"></td>
        <td th:text="${product.product_name}"></td>
        <td th:text="${product.model_name}"></td>
        <td th:text="${product.type_name}"></td>
        <td th:text="${product.product_unit}"></td>
        <td><a href="#" style="color: #0000FF;text-decoration: underline" title="查看出入库明细">[[${product.product_stock}]]</a></td>
        <td th:text="${product.retail_price}"></td>
        <td th:text="${product.min_price}"></td>
        <td th:text="${product.cost_price}"></td>
        <td th:text="${product.trade_price}"></td>
        <td th:text="${product.product_state==0?'禁用':'启用'}"></td>
        <td th:text="${product.serial_number=='0'?'无':'有'}"></td>
        <td th:text="${product.createtime}"></td>
        <td th:text="${product.status=='0'?'未审核':'已审核'}"></td>
        <td>
            <a th:href="@{deleteProduct('id'=${product.id})}">删除</a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <a th:href="@{getProductById('id'=${product.id})}">修改</a>
        </td>
    </tr>

    </tbody>
</table>
<script>
    $(function(){
        var selectObj = [];
        $('#tbo').DataTable({
            "aLengthMenu":[4,6]  , //每页显示数
        });
    });
             $().ready(function () {
                         $("#btnDelete").click(function(){//删除多条
                             // debugger;
                             var checkids = [];
                             var data = [];
                             $("input[name='ckb']:checked").each(function(i){
                                     checkids[i] = $(this).val();
                                 });
                             if(checkids.length<=0){
                                    alert("请选择一条需要被删除的数据")
                                 }else{
                                         $("#tbo").find(":checkbox:checked").each(function(){
                                             var val = $(this).parents().children().children(".proid").val();
                                             // alert(val);
                                             data.push(val);
                                             $.ajax({
                                                 url:"deleteProducts",
                                                 dateType:"json",
                                                 type:"post",
                                                 data:{"proids":val},
                                                 success:function (resp) {
                                                     if (resp!=null||resp!=""){
                                                         alert("成功");
                                                         location.href = "getAllProduct";
                                                     } else {
                                                         alert("失败")
                                                     }
                                                 }
                                             });
                                         });
                                 }
                         });
                 //全选全不选
                 $("#checkAll").click(function(){
                     if($(this).is(':checked')){
                         $("input[name='ckb']").each(function(){
                             $(this).prop("checked",true);
                         });
                     }else{
                         $('input[name="ckb"]').each(function(){
                             $(this).prop("checked",false);
                         });
                     }
                 });

                         //新增数据
                 });

             // function deleteCurrentRow(obj){
             //         var tr=obj.parentNode.parentNode;
             //         var tbody=tr.parentNode;
             //         tbody.removeChild(tr);
             //         //只剩行首时删除表格
             //         if(tbody.rows.length==0) {
             //                 tbody.parentNode.removeChild(tbody);
             //             }
             //     }

</script>
</body>
</html>